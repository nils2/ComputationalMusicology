---
title: "Yellow Claw's Evolutionary Analysis"
author: "Nils Peters - 11642335"
date: "Spring 2021"
output: 
  flexdashboard::flex_dashboard:
    storyboard: true
---


<style>
.sbframe-content {
  line-height: 1.6;
  font-size: 16px;
}
.sbframe-commentary {
  line-height: 1.6;
  font-size: 16px;
}
.navbar {
  color: black;
}
.navbar-fixed-top {
  background-color: gray;
}
#dashboard-container li {
  background-color: #ffff00;
  text-align: center;
  line-height: 800%;
}
#dashboard-container li.active {
  background-image: url("https://i1.sndcdn.com/avatars-000739128925-0ottgs-t500x500.jpg");
  background-size: 270px 120px;
  text-align: center;
}
</style>

```{r Load packages, message=FALSE, echo=FALSE}
library(tidyverse)
library(spotifyr)
library(remotes)
library(usethis)
library(plotly)
library(compmus)
library(DT)
library(forcats)
library(purrr)
```

```{r Load Playlist, echo=FALSE}
YCData <- get_playlist_audio_features("", "4ihYAvvARSvL4yUzdibPrd")
```

```{r Data summary, echo=FALSE}
YCSum <-
  YCData %>%
    summarise(
      mean_speechiness = mean(speechiness),
      mean_acousticness = mean(acousticness),
      mean_liveness = mean(liveness),
      sd_speechiness = sd(speechiness),
      sd_acousticness = sd(acousticness),
      sd_liveness = sd(liveness),
      median_speechiness = median(speechiness),
      median_acousticness = median(acousticness),
      median_liveness = median(liveness),
      mad_speechiness = mad(speechiness),
      mad_acousticness = mad(acousticness),
      mad_liveness = mad(liveness)
    )
```


```{r Change Data, echo=FALSE}
year <- YCData %>% pull(track.album.release_date)
year <- substr(year, 1, 4)
YCData$year <- year
rm(year)

MD <- YCData %>% mutate(year,
               MadDecent = ifelse(year < 2013, "Before", "During"),
               MadDecent = ifelse(year < 2018, MadDecent, "After"))
YCData <- MD
rm(MD)

Lab <- YCData %>% mutate(year,
               Label = ifelse(track.album.name %in% c("Blood For Mercy", 
                                  "Amsterdam Twerk Music", "Los Amsterdam",
                                  "Amsterdam Trap Music", "Amsterdam Trap Music, Vol. 2"),
                                  "MadDecent", "Single"),
               Label = ifelse(track.album.name %in% c("New Blood", "Never Dies", 
                                                      "Eastzane Warriors", "Danger Days",
                                                      "Amsterdam Trap Music, Vol. 3"), 
                              "Barong Family", Label))
YCData <- Lab
rm(Lab)

Lab2 <- YCData %>% mutate(year,
               Albums = ifelse(track.album.name %in% c("Blood For Mercy", 
                                  "Amsterdam Twerk Music", "Los Amsterdam",
                                  "Amsterdam Trap Music", "Amsterdam Trap Music, Vol. 2",
                                  "New Blood", "Never Dies", 
                                  "Eastzane Warriors", "Danger Days",
                                    "Amsterdam Trap Music, Vol. 3"),
                                  track.album.name, "Single"))
YCData <- Lab2
rm(Lab2)

Biz <- YCData %>% mutate(year,
               Bizzey = ifelse(year < 2016, "With", "Without"))
YCData <- Biz
rm(Biz)
```

### A closer look at Loudest MF
```{r}
bzt <-
  get_tidy_audio_analysis("34xsvZ1A2Ou1oo1VyOwQG1") %>% # Change URI.
  compmus_align(bars, segments) %>%                     # Change `bars`
  select(bars) %>%                                      #   in all three
  unnest(bars) %>%                                      #   of these lines.
  mutate(
    pitches =
      map(segments,
        compmus_summarise, pitches,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  ) %>%
  mutate(
    timbre =
      map(segments,
        compmus_summarise, timbre,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  )
```

```{r}
bind_rows(
  bzt %>%
    compmus_self_similarity(pitches, "manhattan") %>%
    mutate(d = d / max(d), type = "Chroma"),
  bzt %>%
    compmus_self_similarity(timbre, "euclidean") %>%
    mutate(d = d / max(d), type = "Timbre")
) %>%
  mutate() %>%
  ggplot(
    aes(
      x = xstart + xduration / 2,
      width = xduration,
      y = ystart + yduration / 2,
      height = yduration,
      fill = d
    )
  ) +
  geom_tile() +
  coord_fixed() +
  facet_wrap(~type) +
  scale_fill_viridis_c(guide = "none") +
  theme_classic() +
  labs(x = "", y = "")

```

***

All the points talked about previously in Looking at the Loudest MF are clearly visible in the chroma-based self-similarity matrix. For example the high and low fluctuations of the same beat from 150 sec to the end of the song is depicted very clearly. However from both matrices it is clear there was no repetition found by spotify. 

### A closer look at DJ turn it up
```{r}
bzt2 <-
  get_tidy_audio_analysis("1ivuWgxFQb2xzxVNSlB1hF") %>% # Change URI.
  compmus_align(bars, segments) %>%                     # Change `bars`
  select(bars) %>%                                      #   in all three
  unnest(bars) %>%                                      #   of these lines.
  mutate(
    pitches =
      map(segments,
        compmus_summarise, pitches,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  ) %>%
  mutate(
    timbre =
      map(segments,
        compmus_summarise, timbre,
        method = "rms", norm = "euclidean"              # Change summary & norm.
      )
  )
```

```{r}
bind_rows(
  bzt2 %>%
    compmus_self_similarity(pitches, "manhattan") %>%
    mutate(d = d / max(d), type = "Chroma"),
  bzt2 %>%
    compmus_self_similarity(timbre, "euclidean") %>%
    mutate(d = d / max(d), type = "Timbre")
) %>%
  mutate() %>%
  ggplot(
    aes(
      x = xstart + xduration / 2,
      width = xduration,
      y = ystart + yduration / 2,
      height = yduration,
      fill = d
    )
  ) +
  geom_tile() +
  coord_fixed() +
  facet_wrap(~type) +
  scale_fill_viridis_c(guide = "none") +
  theme_classic() +
  labs(x = "", y = "")

```

***

From the timbre-based self-similarity matrices a pattern of the song becomes clear. It is visible that from 20 sec to 95 sec in the song the same occurs as from 95 sec to 160 sec. This coincides more with the typical yellow claw style of some repetition in their song, than was the case with Loudest MF.


### Did Yellow Claw evolve over the years?

This question will be researched by using a selfmade chronological playlist of all their songs listed in their spotify page (except remixes). [Yellow Claw](https://yellowclaw.com/) has and probably will be one of my favorites. So comparing their progress over the years to try and find if there are any differences seemed like a logical conclusion. It is interesting because they are not the most famous Dutch DJ, but among peers they are known for having very nostalgic and good songs.

Personally I expect they changed, this could be backed up by the fact that their first songs differ in quality from their first album (released in 2015). This is most likely because their first album was released under the Mad Decent, which is Diplo's recordlabel. I suspect they learned a lot under Diplo's supervision, though I am unsure as to how they changed specifically. Maybe they added more BPM, changed timbres or they completely renewed themselves.

However there might not be a big change at all. Since they have only been active for 10 years of which they spend only 8 producing their own songs. This might barely be enough or fall just short of enough time, especially since the 2021 songs are rather different than the others before. 

"Thunder", "Shotgun", "Till It Hurts", "Amsterdamned", "In My Room" and "DJ Turn It Up" are very typical songs. These are very typical as they define their past and current style in beat and beatdrop. Whereas "Assets", "P*\$\$YRICH", "Wild Mustang", "Villain", "Another Life" and "Kiss Your Lips" are atypical songs. The last one is very strange as it is happy hardcore, a genre that does not suit Yellow Claw's style, the same could be said for the other atypical songs.

### This is Yellow Claw

[The playlist:](https://open.spotify.com/playlist/4ihYAvvARSvL4yUzdibPrd?si=smVI-XMlRRiikn2SXwt1sw)

```{r}
playlistYC <- YCData %>% select(track.name, track.album.release_date)
                
datatable(playlistYC, rownames = FALSE, class = "table1",
          colnames = c('Name', 'Release date'), 
          options = list(scrollY = "500px", pageLength = 120, paging = FALSE))
```

### To Bizzey or not to Bizzey? A-side

```{r First Plot, echo=FALSE}
p1 <- YCData %>% ggplot(aes(year, speechiness, color = Label, size = liveness, 
                      text = paste("Name:", track.name, "\n", "Label:", Label, "\n",
                                  "Speechiness:", speechiness, "\n",
                                  "Liveness:", liveness))) + 
                      geom_point(position = position_jitter(), aes(alpha = 0.8)) +
                      scale_y_log10() +
                      geom_rug(size = 0.2, sides = "l") +      # Add 'fringes' to show data distribution.
                      scale_color_manual(values = c("#FFCA00", "#56B4E9", "#999999")) +
                      facet_wrap(~Bizzey, scales = "free_x") +
                      theme_light() +
                      labs(x = "Year", y = "Speechiness",
                           title = "The change of Bizzey's departure",
                           subtitle = "In Speechiness and Liveness vs Years <br>") +
                      guides(size = FALSE, alpha = FALSE)

ggplotly(p1, tooltip = "text") %>%
  layout(title = list(text = paste("The change of Bizzey's departure",
                                    "<br>",
                                    "<sup>",
                                    "In Speechiness and Liveness vs Years",
                                    "</sup>")),
          margin = list(t = 100))
```

***

This plot shows the difference in speechiness and liveness in the time Bizzey was and wasn't part of the group. One can clearly see that after Bizzey left the groep the speechiness contained more variety and got a higher mean. Also the liveness became more apparent. It is strange to see a change in the speechiness since Bizzey was a MC. You would expect the departure of a MC to decrease the speechiness of produced songs, but this is not the case here.

### To Bizzey or not to Bizzey? B-side

```{r echo=FALSE}
# Possible interesting comparisons
# year/instrumentalness
# energy/loudness
# energy/speechiness
# energy/instrumentalness
# speechiness/loudness
# acousticness/loudness

p2 <- YCData %>% ggplot(aes(year, acousticness, color = Label, size = liveness, 
                      text = paste("Name:", track.name, "\n", "Label:", Label, "\n",
                                  "Acousticness:", acousticness, "\n",
                                  "Liveness:", liveness))) + 
                      geom_point(position = position_jitter(), aes(alpha = 0.8)) +
                      scale_y_log10() +
                      geom_rug(size = 0.2, sides = "l") +      # Add 'fringes' to show data distribution.
                      scale_color_manual(values = c("#FFCA00", "#56B4E9", "#999999")) +
                      facet_wrap(~Bizzey, scales = "free_x") +
                      theme_light() +
                      labs(x = "Year", y = "Acousticness",
                           title = "The change of Bizzey's departure", 
                           subtitle = "In Acousticness and Liveness vs Years") +
                      guides(size = FALSE, alpha = FALSE)

ggplotly(p2, tooltip = "text") %>%
  layout(title = list(text = paste("The change of Bizzey's departure",
                                    "<br>",
                                    "<sup>",
                                    "In Acousticness and Liveness vs Years",
                                    "</sup>")),
          margin = list(t = 100))
```

***

This plot shows the difference in acousticness and liveness in the time Bizzey was and wasn't part of the group. One can clearly see that after Bizzey left the groep the acousticness contained more variety and got a higher mean. Also the liveness became more apparent. It is strange to see a change in the acousticness since Bizzey was a MC. You would expect the departure of a MC to decrease the acousticness of produced songs, but this is not the case here.

```{r echo=FALSE}

#p3 <- ggplot(data = YCData %>%
#               arrange(energy) %>%
#             slice(1:5, (n()-4):n()),
#             aes(x = energy, y = track.name, color = Label, shape = MadDecent)) +
#            geom_point(size = 4) +
#            geom_segment(aes(xend = 0, yend = track.name), size = 2)
```

### Looking at the Loudest MF

```{r}
LMF <-
  get_tidy_audio_analysis("34xsvZ1A2Ou1oo1VyOwQG1") %>%
  select(segments) %>%
  unnest(segments) %>%
  select(start, duration, pitches)
```

```{r}
LMF %>%
  mutate(pitches = map(pitches, compmus_normalise, "chebyshev")) %>%
  compmus_gather_chroma() %>% 
  ggplot(
    aes(
      x = start + duration / 2,
      width = duration,
      y = pitch_class,
      fill = value
    )
  ) +
  geom_tile() +
  labs(x = "Time (s)", y = NULL, fill = "Magnitude", title = "Chromagram Loudest MF") +
  theme_minimal() +
  scale_fill_viridis_c()
```


***

Here we can see the chromagram of [Loudest MF](https://open.spotify.com/track/34xsvZ1A2Ou1oo1VyOwQG1?si=5xdFXOTaSeWKOmF3pZgbwg), which scored very high on speechiness.

You can see the fade away of sound between 28 and 36 sec as only G# is present which is the muffled tone.
After this it is clear that there is a distinct beat since it is visible in A/Ab and E/Eb and slightly in C#/C. This until around 50 sec where the rapper starts and the spectrum contains more yellow and thus there are more fequencies present until around 65 sec.
You can see and hear at 85 sec the second beat drop, with a lot of clean notes being played until 115 sec. Also you can see at 105 sec is where the rapper says 'bounce' a couple of times as the C# is faded in the C. 
Then the rapper starts again as visible in the amount of present frequencies. At 155 sec the third beat starts decently clean as most is present in G# but around 160 seconds muffled sound is added to the beat and the beat gets more components from then on. However it is still clear that the music fluctuates between high and low. 

### The answer
